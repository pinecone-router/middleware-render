function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function t(e,t,n){let o=(new DOMParser).parseFromString(e,"text/html");o=o.querySelector(t);let r=function(e,t,n){let o=e.querySelectorAll("[x-router]");switch(o.length){case 0:"body"==t&&(n=[]);break;case 1:document.querySelector("[x-router]").setAttribute("x-router",""),o[0].isEqualNode(document.querySelector("[x-router]"))?(o[0].setAttribute("x-router","loaded"),document.querySelector("[x-router]").remove()):(n=[],document.querySelector("[x-router]").remove());break;default:throw new Error("Pinecone Router x-render: there can only be one router in the same page")}return{doc:e,routes:n}}(o,t,n);o=r.doc,function(e,t){document.querySelector(t).innerHTML=e}(e=o.innerHTML,t),window.PineconeRouter.routes=r.routes}const n={version:"0.0.3",name:"render",settings:{enable:!1,selector:"body",preload:!0,preloadTime:200,preloaded:{path:"",content:null}},loadStart:new Event("pinecone-start"),loadEnd:new Event("pinecone-end"),init(t,n){var o,r,i;if(null!=n&&null!=(o=n.middlewares)&&o.views)throw new Error(`Pinecone Router ${this.name}: Cannot use views middleware along with render.`);if(this.settings=e({},this.settings,null!=(r=null==n||null==(i=n.middlewares)?void 0:i[this.name])?r:{}),this.settings.enable){if(n.hash)throw new Error(`Pinecone Router ${this.name}: Cannot use x-render along with x-hash.`);window.PineconeRouter.settings.allowNoHandler=!0,t.$el.setAttribute("x-router","loaded"),this.settings.preload&&this.interceptLinks(n.hash)}},interceptLinks(e){var t=this;document.body.addEventListener("onmouseover",function(n){let o=n.target,r=n.path||(n.composedPath?n.composedPath():null);if(r)for(let e=0;e<r.length;e++)if(r[e].nodeName&&"A"===r[e].nodeName.toUpperCase()&&r[e].href){o=r[e];break}if(!o.hasAttribute("native")){var i=window.PineconeRouter.validLink(o,e);i.valid&&t.settings.preloaded.path!=i.link&&window.setTimeout(function(){fetch(i.link).then(e=>e.text()).then(e=>{t.settings.preloaded.path=path,t.settings.preloaded.content=e})},t.settings.preloadTime)}})},onHandlersExecuted(e,n,o){if(this.settings.enable&&!o&&route){if(this.settings.preloaded.path==n)return t(this.settings.preloaded.content,this.settings.selector,window.PineconeRouter.routes),this.settings.preloaded.path=null,this.settings.preloaded.content=null,window.dispatchEvent(this.loadEnd),!1;fetch(n).then(e=>e.text()).then(e=>(t(e,this.settings.selector,window.PineconeRouter.routes),window.dispatchEvent(this.loadEnd),!1))}},onBeforeHandlersExecuted(e,t,n){window.dispatchEvent(this.loadStart)}};null==window.PineconeRouterMiddlewares?window.PineconeRouterMiddlewares=[n]:window.PineconeRouterMiddlewares.push(n);
//# sourceMappingURL=index.modern.js.map
